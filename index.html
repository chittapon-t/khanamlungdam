<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å - ‡∏Ç‡∏ô‡∏≥‡∏•‡∏∏‡∏á‡∏î‡∏≥ ‡πÅ‡∏Ñ‡∏°‡∏õ‡πå‡∏õ‡∏¥‡πâ‡∏á</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background-color: #fcfaf7; }
        .camping-green { background-color: #1b4332; }
        .camping-brown { background-color: #6d4c41; }
        .card-selected { border: 2px solid #1b4332; background-color: #f0fdf4; }
    </style>
</head>
<body class="pb-24">
    <div id="loading" class="fixed inset-0 bg-white z-50 flex flex-col items-center justify-center">
        <div class="w-12 h-12 border-4 border-emerald-800 border-t-transparent rounded-full animate-spin"></div>
        <p class="mt-4 text-emerald-800 font-bold">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏ï‡πá‡∏ô‡∏ó‡πå‡πÉ‡∏´‡πâ‡∏Ñ‡∏∏‡∏ì...</p>
    </div>

    <!-- Header -->
    <header class="camping-green text-white p-6 rounded-b-3xl shadow-lg">
        <h1 class="text-2xl font-bold">‡∏Ç‡∏ô‡∏≥‡∏•‡∏∏‡∏á‡∏î‡∏≥ ‡πÅ‡∏Ñ‡∏°‡∏õ‡πå‡∏õ‡∏¥‡πâ‡∏á</h1>
        <p class="text-emerald-100 text-sm">‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡∏£‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏Ç‡∏ô‡∏≥‡πÇ‡∏õ</p>
        <div id="userProfile" class="mt-4 flex items-center space-x-3 bg-white/10 p-2 rounded-full w-fit">
            <img id="userImg" class="w-8 h-8 rounded-full" src="" alt="">
            <span id="userName" class="text-sm pr-2">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</span>
        </div>
    </header>

    <main class="p-4 max-w-md mx-auto space-y-6">
        <!-- Date Selection -->
        <section class="bg-white p-5 rounded-2xl shadow-sm border border-emerald-50">
            <h2 class="font-bold text-emerald-900 mb-4 flex items-center">
                <span class="bg-emerald-100 p-1 rounded mr-2">üìÖ</span> ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å
            </h2>
            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="text-xs text-gray-500 block mb-1">‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏¥‡∏ô</label>
                    <input type="date" id="checkin" class="w-full border rounded-xl p-3 text-sm focus:ring-2 ring-emerald-500 outline-none" onchange="calculatePrice()">
                </div>
                <div>
                    <label class="text-xs text-gray-500 block mb-1">‡∏ß‡∏±‡∏ô‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏≠‡∏≤‡∏ó‡πå</label>
                    <input type="date" id="checkout" class="w-full border rounded-xl p-3 text-sm focus:ring-2 ring-emerald-500 outline-none" onchange="calculatePrice()">
                </div>
            </div>
        </section>

        <!-- Room Selection -->
        <section>
            <h2 class="font-bold text-emerald-900 mb-3 ml-2">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å</h2>
            <div id="roomContainer" class="grid gap-3">
                <!-- Example Room Item -->
                <div class="bg-white p-4 rounded-2xl border-2 border-transparent shadow-sm flex justify-between items-center" onclick="toggleRoom('h1', 1600, '‡πÇ‡∏Æ‡∏°‡∏™‡πÄ‡∏ï‡∏¢‡πå‡∏´‡∏ô‡∏≥‡πÇ‡∏õ', this)">
                    <div>
                        <h3 class="font-bold">‡πÇ‡∏Æ‡∏°‡∏™‡πÄ‡∏ï‡∏¢‡πå‡∏´‡∏ô‡∏≥‡πÇ‡∏õ</h3>
                        <p class="text-xs text-gray-500">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 4-8 ‡∏Ñ‡∏ô</p>
                        <p class="text-emerald-700 font-bold mt-1">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô ‡∏ø1,600</p>
                    </div>
                    <div class="text-emerald-200">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>
                    </div>
                </div>
                <!-- ... other rooms ... -->
            </div>
        </section>

        <!-- Payment Section -->
        <section id="paymentSection" class="bg-white p-5 rounded-2xl shadow-sm space-y-4">
            <h2 class="font-bold text-emerald-900">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥</h2>
            <div class="bg-emerald-50 p-4 rounded-xl text-center border-2 border-dashed border-emerald-200">
                <p class="text-xs text-gray-600 mb-1">‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô‡∏°‡∏±‡∏î‡∏à‡∏≥ (50% ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡πà‡∏≤‡∏´‡πâ‡∏≠‡∏á)</p>
                <p id="depositDisplay" class="text-3xl font-bold text-red-600">‡∏ø0</p>
                <div class="mt-4 bg-white p-2 inline-block rounded-lg shadow-inner">
                    <img id="qrCode" src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=0615924262" class="w-32 h-32" alt="PromptPay">
                </div>
                <p class="mt-2 text-xs font-bold">‡∏≠‡∏•‡∏á‡∏Å‡∏ï ‡∏ó‡∏ß‡∏µ‡∏ú‡πà‡∏≠‡∏á (061-592-4262)</p>
            </div>
            
            <div class="space-y-2">
                <label class="text-sm font-bold">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ</label>
                <input type="file" id="slipInput" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-emerald-50 file:text-emerald-700">
            </div>

            <div class="flex items-center space-x-2 mt-4">
                <input type="checkbox" id="terms" class="w-4 h-4 rounded text-emerald-600">
                <label for="terms" class="text-xs text-gray-500">‡∏â‡∏±‡∏ô‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏ô‡πÇ‡∏¢‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</label>
            </div>
        </section>
    </main>

    <!-- Footer Bar -->
    <div class="fixed bottom-0 left-0 right-0 bg-white border-t p-4 shadow-[0_-4px_10px_rgba(0,0,0,0.05)] flex justify-between items-center max-w-md mx-auto">
        <div>
            <p class="text-[10px] text-gray-400 uppercase font-bold">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
            <p id="totalDisplay" class="text-xl font-bold text-emerald-800">‡∏ø0</p>
        </div>
        <button onclick="handleBooking()" class="camping-green text-white px-8 py-3 rounded-2xl font-bold shadow-lg active:scale-95 transition-transform">
            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á
        </button>
    </div>

    <script>
        const LIFF_ID = '2008863563-tuai5kaC';
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwb9VWt0rQYJ2dJa9jQKM23YRKsx-YReKnqJTiqGRbg26jEMtPP-RzxDbe_BahxUiSu5g/exec';

        let state = {
            lineId: '',
            lineName: '',
            selectedRooms: [],
            checkIn: '',
            checkOut: '',
            isSpecialDate: false
        };

        async function initLiff() {
            try {
                await liff.init({ liffId: LIFF_ID });
                if (!liff.isLoggedIn()) {
                    liff.login();
                } else {
                    const profile = await liff.getProfile();
                    state.lineId = profile.userId;
                    state.lineName = profile.displayName;
                    document.getElementById('userName').innerText = profile.displayName;
                    document.getElementById('userImg').src = profile.pictureUrl;
                    document.getElementById('loading').style.display = 'none';
                }
            } catch (err) {
                console.error(err);
            }
        }

        function toggleRoom(id, price, name, el) {
            const index = state.selectedRooms.findIndex(r => r.id === id);
            if (index > -1) {
                state.selectedRooms.splice(index, 1);
                el.classList.remove('card-selected');
            } else {
                state.selectedRooms.push({ id, price, name });
                el.classList.add('card-selected');
            }
            calculatePrice();
        }

        function calculatePrice() {
            const roomTotal = state.selectedRooms.reduce((sum, r) => sum + r.price, 0);
            const deposit = state.isSpecialDate ? roomTotal : (roomTotal * 0.5);
            
            document.getElementById('totalDisplay').innerText = `‡∏ø${roomTotal.toLocaleString()}`;
            document.getElementById('depositDisplay').innerText = `‡∏ø${deposit.toLocaleString()}`;
        }

        async function handleBooking() {
            if (!document.getElementById('terms').checked) {
                return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏¢‡∏≠‡∏°‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á');
            }
            
            // Logic for file conversion to base64 and posting to SCRIPT_URL
            // ... API call to submitBooking ...
        }

        window.onload = initLiff;
    </script>
</body>
</html>
