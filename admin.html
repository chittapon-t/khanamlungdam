<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô - ‡∏Ç‡∏ô‡∏≥‡∏•‡∏∏‡∏á‡∏î‡∏≥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <!-- FullCalendar -->
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <style>
        body { font-family: 'Kanit', sans-serif; padding-bottom: 90px; }
        .tab-active { color: #059669; border-top: 3px solid #059669; background: #f0fdf4; }
        .card-confirmed { border-left: 6px solid #10b981; }
        .card-pending { border-left: 6px solid #f59e0b; }
        .animate-in { animation: fadeIn 0.4s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        #calendar { background: white; border-radius: 1.5rem; padding: 15px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        .fc-toolbar-title { font-size: 1.1rem !important; font-weight: bold; color: #064e3b; }
        .fc-button { background: #065f46 !important; border: none !important; font-size: 0.8rem !important; }
        ::-webkit-scrollbar { display: none; }
        .stat-card { transition: transform 0.2s; }
        .stat-card:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">

    <!-- Loading Overlay -->
    <div id="loading" class="fixed inset-0 bg-black/70 z-[100] flex items-center justify-center hidden backdrop-blur-sm">
        <div class="bg-white p-8 rounded-3xl text-center shadow-2xl">
            <div class="animate-spin rounded-full h-12 w-12 border-4 border-emerald-600 border-t-transparent mx-auto"></div>
            <p id="loadingText" class="mt-4 font-bold text-emerald-900">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-emerald-900 text-white p-5 sticky top-0 z-40 shadow-xl flex justify-between items-center rounded-b-[2rem]">
        <div>
            <h1 class="font-bold text-xl" id="headerTitle">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h1>
            <p class="text-[10px] text-emerald-300 tracking-widest uppercase opacity-80">Management System v2.6</p>
        </div>
        <button onclick="fetchData()" class="p-3 bg-emerald-800 rounded-2xl active:scale-90 transition-all">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke-width="2.5" stroke-linecap="round"/></svg>
        </button>
    </header>

    <main class="p-4 max-w-2xl mx-auto min-h-screen">
        
        <!-- Section: ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î -->
        <section id="tab-home" class="tab-content hidden animate-in space-y-4">
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-white p-5 rounded-[2rem] shadow-sm border border-slate-100 stat-card">
                    <p class="text-xs text-slate-400 font-bold uppercase">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <h2 id="stat-today-bookings" class="text-3xl font-bold text-emerald-700 mt-1">0</h2>
                </div>
                <div class="bg-white p-5 rounded-[2rem] shadow-sm border border-slate-100 stat-card">
                    <p class="text-xs text-slate-400 font-bold uppercase">‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>
                    <h2 id="stat-pending-bookings" class="text-3xl font-bold text-orange-500 mt-1">0</h2>
                </div>
                <div class="bg-white p-5 rounded-[2rem] shadow-sm border border-slate-100 stat-card col-span-2">
                    <p class="text-xs text-slate-400 font-bold uppercase">‡∏¢‡∏≠‡∏î‡∏°‡∏±‡∏î‡∏à‡∏≥‡∏£‡∏ß‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</p>
                    <h2 id="stat-monthly-revenue" class="text-3xl font-bold text-slate-800 mt-1">‡∏ø0</h2>
                </div>
            </div>

            <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100">
                <h3 class="font-bold text-emerald-900 mb-4 flex items-center justify-between">
                    <span>‚è≥ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</span>
                    <button onclick="switchTab('bookings', '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')" class="text-xs text-emerald-600">‡∏î‡∏π‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ></button>
                </h3>
                <div id="quick-pending-list" class="space-y-3"></div>
            </div>
        </section>

        <!-- Section: ‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô -->
        <section id="tab-calendar" class="tab-content hidden animate-in">
            <div id="calendar" class="mb-4"></div>
            <div class="bg-white p-4 rounded-2xl border border-slate-200 flex justify-around text-xs font-bold">
                <div class="flex items-center"><span class="w-3 h-3 bg-emerald-500 rounded-full mr-2"></span> ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                <div class="flex items-center"><span class="w-3 h-3 bg-orange-400 rounded-full mr-2"></span> ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
            </div>
        </section>

        <!-- Section: ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î -->
        <section id="tab-bookings" class="tab-content hidden space-y-4 animate-in">
            <div class="relative group">
                <input type="text" id="searchBooking" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠, ‡πÄ‡∏ö‡∏≠‡∏£‡πå, ID ‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á..." 
                       class="w-full p-4 pl-12 rounded-2xl border-none shadow-inner bg-white focus:ring-2 focus:ring-emerald-500 transition-all"
                       onkeyup="renderCards()">
                <svg class="w-6 h-6 absolute left-4 top-4 text-slate-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" stroke-width="2"/></svg>
            </div>
            <div id="allBookingCards" class="space-y-4"></div>
        </section>

        <!-- Section: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ -->
        <section id="tab-settings" class="tab-content hidden space-y-6 animate-in">
            <!-- Promo Codes -->
            <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100">
                <h3 class="font-bold text-emerald-900 mb-4 flex items-center">
                    <span class="mr-2 text-xl">üéüÔ∏è</span> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ñ‡πâ‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î
                </h3>
                <div class="space-y-3">
                    <input type="text" id="promoCode" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÇ‡∏Ñ‡πâ‡∏î (‡πÄ‡∏ä‡πà‡∏ô SUMMER20)" class="w-full bg-slate-50 p-3 rounded-xl border-none focus:ring-2 focus:ring-emerald-500">
                    <div class="flex gap-2">
                        <input type="number" id="promoValue" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" class="flex-1 bg-slate-50 p-3 rounded-xl border-none">
                        <select id="promoType" class="w-24 bg-slate-50 p-3 rounded-xl border-none font-bold text-emerald-700">
                            <option value="‡∏ö‡∏≤‡∏ó">‡∏ö‡∏≤‡∏ó</option>
                            <option value="%">%</option>
                        </select>
                    </div>
                    <button onclick="addPromoCode()" class="w-full bg-emerald-700 text-white py-4 rounded-xl font-bold shadow-lg shadow-emerald-100 active:scale-95 transition-all">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏´‡∏°‡πà</button>
                </div>
                <div id="promoList" class="mt-6 space-y-2 border-t pt-4"></div>
            </div>

            <!-- Special Dates -->
            <div class="bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100">
                <h3 class="font-bold text-emerald-900 mb-4 flex items-center">
                    <span class="mr-2 text-xl">üìÖ</span> ‡∏ß‡∏±‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© (‡∏°‡∏±‡∏î‡∏à‡∏≥ 100%)
                </h3>
                <div class="flex gap-2 mb-4">
                    <input type="date" id="newSpecialDate" class="flex-1 bg-slate-50 p-3 rounded-xl border-none">
                    <button onclick="addSpecialDate()" class="bg-emerald-600 text-white px-6 rounded-xl font-bold">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
                </div>
                <div id="specialDateList" class="flex flex-wrap gap-2"></div>
            </div>
        </section>
    </main>

    <!-- Navigation -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/80 backdrop-blur-md border-t border-slate-100 p-2 flex justify-around z-50">
        <button onclick="switchTab('home', '‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î')" id="nav-home" class="flex-1 flex flex-col items-center py-2 text-slate-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke-width="2"/></svg>
            <span class="text-[10px] mt-1 font-bold">‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</span>
        </button>
        <button onclick="switchTab('calendar', '‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á')" id="nav-calendar" class="flex-1 flex flex-col items-center py-2 text-slate-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" stroke-width="2"/></svg>
            <span class="text-[10px] mt-1 font-bold">‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô</span>
        </button>
        <button onclick="switchTab('bookings', '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î')" id="nav-bookings" class="flex-1 flex flex-col items-center py-2 text-slate-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M4 6h16M4 12h16M4 18h7" stroke-width="2"/></svg>
            <span class="text-[10px] mt-1 font-bold">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
        </button>
        <button onclick="switchTab('settings', '‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö')" id="nav-settings" class="flex-1 flex flex-col items-center py-2 text-slate-400">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" stroke-width="2"/></svg>
            <span class="text-[10px] mt-1 font-bold">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
        </button>
    </nav>

    <script>
        const API_URL = "https://script.google.com/macros/s/AKfycbwb9VWt0rQYJ2dJa9jQKM23YRKsx-YReKnqJTiqGRbg26jEMtPP-RzxDbe_BahxUiSu5g/exec";
        
        let allData = [];
        let specialDates = [];
        let promoCodes = [];
        let calendar = null;

        function switchTab(tab, title) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById(`tab-${tab}`).classList.remove('hidden');
            document.getElementById('headerTitle').innerText = title;
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('tab-active', 'text-slate-400'));
            document.getElementById(`nav-${tab}`).classList.add('tab-active');
            
            if(tab === 'calendar') {
                setTimeout(() => {
                    if (!calendar) initCalendar();
                    calendar.updateSize();
                    calendar.render();
                }, 100);
            }
            window.scrollTo(0,0);
        }

        function initCalendar() {
            calendar = new FullCalendar.Calendar(document.getElementById('calendar'), {
                initialView: 'dayGridMonth',
                locale: 'th',
                headerToolbar: { left: 'prev,next', center: 'title', right: 'today' },
                events: prepareEvents(),
                eventClick: (info) => {
                    document.getElementById('searchBooking').value = info.event.extendedProps.id;
                    switchTab('bookings', '‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                    renderCards();
                }
            });
            calendar.render();
        }

        function prepareEvents() {
            return allData.filter(i => i.Status !== '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å').map(item => ({
                title: `${item.CustomerName} (${item.Rooms})`,
                start: item.CheckIn.split('T')[0],
                end: item.CheckOut.split('T')[0],
                color: item.Status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß' ? '#10b981' : '#fbbf24',
                extendedProps: { id: item.BookingID }
            }));
        }

        async function fetchData() {
            document.getElementById('loading').classList.remove('hidden');
            try {
                const res = await fetch(API_URL);
                const data = await res.json();
                allData = data.bookings || [];
                specialDates = data.specialDates || [];
                promoCodes = data.promoCodes || [];

                updateStats();
                renderCards();
                renderSettings();
                if(calendar) {
                    calendar.removeAllEvents();
                    calendar.addEventSource(prepareEvents());
                }
            } catch (e) {
                console.error("Fetch Error:", e);
            } finally {
                document.getElementById('loading').classList.add('hidden');
            }
        }

        function updateStats() {
            const today = new Date().toISOString().split('T')[0];
            const currentMonth = new Date().getMonth();
            const currentYear = new Date().getFullYear();

            const todayBookings = allData.filter(i => i.CheckIn.startsWith(today)).length;
            const pendingList = allData.filter(i => i.Status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
            const monthlyRevenue = allData
                .filter(i => {
                    const d = new Date(i.CheckIn);
                    return d.getMonth() === currentMonth && d.getFullYear() === currentYear && i.Status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß';
                })
                .reduce((sum, item) => sum + Number(item.Deposit || 0), 0);

            document.getElementById('stat-today-bookings').innerText = todayBookings;
            document.getElementById('stat-pending-bookings').innerText = pendingList.length;
            document.getElementById('stat-monthly-revenue').innerText = '‡∏ø' + monthlyRevenue.toLocaleString();

            const quickList = document.getElementById('quick-pending-list');
            quickList.innerHTML = pendingList.length ? pendingList.slice(0, 5).map(item => `
                <div class="flex items-center justify-between p-3 bg-slate-50 rounded-xl border border-slate-100">
                    <div>
                        <p class="font-bold text-sm text-slate-800">${item.CustomerName}</p>
                        <p class="text-[10px] text-slate-400">${item.Rooms} | ${new Date(item.CheckIn).toLocaleDateString('th-TH')}</p>
                    </div>
                    <button onclick="viewBookingDetail('${item.BookingID}')" class="bg-emerald-600 text-white px-3 py-1.5 rounded-lg text-[10px] font-bold">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
                </div>
            `).join('') : '<p class="text-center text-slate-400 py-4 text-xs italic">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏≤‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>';
        }

        function renderCards() {
            const query = document.getElementById('searchBooking').value.toLowerCase();
            const container = document.getElementById('allBookingCards');
            const filtered = allData.filter(i => 
                (i.CustomerName || "").toLowerCase().includes(query) || 
                (i.BookingID || "").toLowerCase().includes(query) ||
                (i.Tel || "").includes(query)
            );

            container.innerHTML = filtered.map(item => `
                <div class="bg-white rounded-[2rem] p-5 shadow-sm border ${item.Status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß' ? 'card-confirmed' : 'card-pending'} animate-in">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <p class="text-[10px] text-emerald-600 font-bold uppercase">${item.BookingID}</p>
                            <h3 class="font-bold text-lg text-slate-800">${item.CustomerName}</h3>
                        </div>
                        <span class="text-[10px] px-3 py-1 rounded-full font-bold ${item.Status === '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß' ? 'bg-emerald-500 text-white' : 'bg-orange-400 text-white'}">${item.Status}</span>
                    </div>
                    <div class="bg-slate-50 p-4 rounded-2xl text-xs space-y-2 mb-4">
                        <p><b>‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å:</b> ${item.Rooms} (${item.Guests} ‡∏ó‡πà‡∏≤‡∏ô)</p>
                        <p><b>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</b> ${new Date(item.CheckIn).toLocaleDateString('th-TH')} - ${new Date(item.CheckOut).toLocaleDateString('th-TH')}</p>
                    </div>
                    <div class="flex justify-between items-center">
                        <div>
                            <p class="text-[9px] text-slate-400 uppercase font-bold">‡∏°‡∏±‡∏î‡∏à‡∏≥</p>
                            <p class="text-xl font-bold text-emerald-700">‡∏ø${Number(item.Deposit).toLocaleString()}</p>
                        </div>
                        <div class="flex gap-2">
                             <a href="${item.SlipURL}" target="_blank" class="bg-slate-800 text-white p-3 rounded-xl text-[10px] font-bold">‡∏™‡∏•‡∏¥‡∏õ</a>
                             <button onclick="deleteItem('${item.BookingID}')" class="bg-red-500 text-white p-3 rounded-xl text-[10px] font-bold">‡∏•‡∏ö</button>
                        </div>
                    </div>
                    ${item.Status === '‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö' ? `
                        <button onclick="confirmBooking('${item.BookingID}')" class="w-full mt-4 bg-emerald-600 text-white py-3 rounded-xl font-bold">‚úÖ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô</button>
                    ` : ''}
                </div>
            `).join('');
        }

        async function postData(action, payload) {
            document.getElementById('loading').classList.remove('hidden');
            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    body: JSON.stringify({ action, ...payload })
                });
                const res = await response.json();
                if(res.status === 'success') fetchData();
                else alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + res.message);
            } catch (e) { alert("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î"); }
            finally { document.getElementById('loading').classList.add('hidden'); }
        }

        function confirmBooking(id) { if(confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏±‡∏ö‡∏¢‡∏≠‡∏î‡∏°‡∏±‡∏î‡∏à‡∏≥?')) postData('updateStatus', { bookingId: id, status: '‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡πÅ‡∏•‡πâ‡∏ß' }); }
        function deleteItem(id) { if(confirm('‡∏•‡∏ö‡∏ñ‡∏≤‡∏ß‡∏£?')) postData('deleteBooking', { bookingId: id }); }
        function addPromoCode() {
            const code = document.getElementById('promoCode').value;
            const value = document.getElementById('promoValue').value;
            const type = document.getElementById('promoType').value;
            if(code && value) postData('addPromo', { code, value, type });
        }
        function addSpecialDate() {
            const date = document.getElementById('newSpecialDate').value;
            if(date) postData('addSpecialDate', { date });
        }
        function renderSettings() {
            const dList = document.getElementById('specialDateList');
            dList.innerHTML = specialDates.map(d => `<div class="bg-orange-100 p-2 rounded-lg text-xs font-bold">${new Date(d).toLocaleDateString('th-TH')}</div>`).join('');
        }

        window.onload = () => { switchTab('home', '‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î'); fetchData(); };
    </script>
</body>
</html>
